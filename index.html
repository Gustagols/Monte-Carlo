<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>monte-carlo</title>
</head>

<style>
    body {
        padding-top: 50px;
        background-color: rgb(253, 253, 253);
    }

    .light-mode-icon {
        position: fixed;
        top: 20px; right: 30px;
        transition: all 0.15s ease;
        cursor: pointer;
    }

    .light-mode-icon:hover {  opacity: 0.8; }
    .light-mode-icon:active { opacity: 1; }
    
    .title-container {
        display: grid;
        place-content: center;
        margin-bottom: 20px;
    }

    .title-txt { 
        font-size: 20px; 
    }

    .board-container {
        display: grid;
        place-content: center;
        margin-bottom: 50px;
    }

    #board {
         width: 350px;
         height: 350px;
    }

    #points-input { 
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 8px;
        border: none;
        font: italic normal 12px monospace;
        width: 200px;
    }

    .test-container {
        display: flex;
        justify-content: center;
        align-items: center;
    }

    /* dark-mode */    
    body.dark-mode {
        background-color: #121212;
        color: #ffffff;
    }

    body.dark-mode canvas {
        background-color: #1e1e1e;
        border-color: #333;
    }

    body.dark-mode input {
        background-color: #333;
        color: #fff;
        border: 1px solid #555;
    }
    
    body.dark-mode .light-mode-icon {
        filter: invert(1);
    }

    @media (max-width: 600px) {

        #board {
            width: 300px;
            height: 300px;
         }      

         .title-container {
            margin-top: 50px;
         }    
    }

</style>

<body>
    <img class="light-mode-icon" 
    src="images/lightMode-icon.png" alt="light-mode-icon">
    
    <div class="title-container">
        <p class="title-txt">Monte Carlo Simulation</p>
    </div>
    <div class="board-container">
        <canvas id="board" width="400" height="400"></canvas>
    </div>
    <div class="test-container">
        <input id="points-input" type="number" placeholder="Enter number of points">
    </div>

    <script>
        const pointInput = document.getElementById("points-input");
        const board = document.getElementById("board");   
        
        const themeIcon = document.querySelector(".light-mode-icon");
        const body = document.body;

        themeIcon.addEventListener("click", () => {
            body.classList.toggle("dark-mode");
        });

        function rodarSimulacao() {
            const n = parseInt(pointInput.value);

            fetch("/points?n=" + n)
                .then(response => response.json())
                .then(data => {
                    const ctx = board.getContext("2d");
                    ctx.clearRect(0, 0, 400, 400); // Limpa a tela anterior
                    
                     const isDark = document.body.classList.contains("dark-mode");
                     const corDentro = isDark ? "aqua" : "blue";
                     const corFora   = isDark ? "red" : "red";

                    data.forEach(point => {
                        // 1. Coordenadas para o Desenho (Pixels 0-400)
                        const x = (point[0] + 1) * 200;
                        const y = (point[1] + 1) * 200;

                        // 2. Coordenadas para a MatemÃ¡tica (Valores -1 a 1)
                        const xPoint = point[0] * point[0];
                        const yPoint = point[1] * point[1];

                        // 3. Decide a cor
                        if (xPoint + yPoint > 1) {
                            ctx.fillStyle = corFora;
                        } else {
                            ctx.fillStyle = corDentro;
                        }

                        // 4. Desenha
                        ctx.fillRect(x, y, 2, 2);
                    });
                });
            }

            pointInput.addEventListener('keydown', (event) => {
                if (event.key === "Enter") { 
                    rodarSimulacao(); 
                }
            });
    </script>
</body>
</html>
